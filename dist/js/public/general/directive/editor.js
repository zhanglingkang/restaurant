/*! ppz_website 2015-01-12 6:59:27 PM */
"use strict";define(function(a){function b(){var a=["Serif","Sans","Arial","Arial Black","Courier","Courier New","Comic Sans MS","Helvetica","Impact","Lucida Grande","Lucida Sans","Tahoma","Times","Times New Roman","Verdana"],b=$(".font-set").siblings(".dropdown-menu");$.each(a,function(a,c){b.append($('<li><a data-edit="fontName '+c+'" style="font-family:\''+c+"'\">"+c+"</a></li>"))}),$("a[title]").tooltip({container:"body"}),$(".dropdown-menu input").click(function(){return!1}).change(function(){$(this).parent(".dropdown-menu").siblings(".dropdown-toggle").dropdown("toggle")}).keydown("esc",function(){this.value="",$(this).change()}),$("[data-role=magic-overlay]").each(function(){var a=$(this),b=$(a.data("target"));a.css("opacity",0).css("position","absolute").offset(b.offset()).width(b.outerWidth()).height(b.outerHeight())})}var c=a("app"),d=a("public/local/system"),e=a("public/general/util");a("../jquery-plugin/editor"),a("public/local/http"),c.directive("editor",["$compile","httpService",function(a,c){return{restrict:"E",replace:!0,scope:!0,templateUrl:d.getTplAbsolutePath("tpl/directive/editor.html"),compile:function(a,d){var f=$(a),g=function(a,d,g){var h=f.find("#editor");b(),h.wysiwyg(),h.on("fileSelected",function(a,b){var d=b[0];d&&/image/.test(d.type)&&c.post({r:"index/imageUpload",data:{up_file:b[0]},success:function(a){h.trigger("fileUploaded",[a.image_url])}})}),h.on("editorContentChanged",function(b,c){a.$parent.$apply(function(){f.find("textarea").html(c),e.setPropertyValue(a.$parent,g.ngModel,c)})}),a.$parent.$watch(g.ngModel,function(){var b=h.cleanHtml(),c=e.getPropertyValue(a.$parent,g.ngModel);c!==b&&h.html(c)})},h={};for(var i in d)d.hasOwnProperty(i)&&(i.match(/^ng/)||"required"===i||"name"===i)&&(h[d.$attr[i]]=d[i]);return f.find("textarea").attr(h),g}}}])});